{
  "swagger": "2.0",
  "info": {
    "contact": {}
  },
  "paths": {
    "/": {
      "post": {
        "description": "Submit raw data for remote signing. Returns a UUID to track the signing request.",
        "consumes": ["application/json", "application/octet-stream"],
        "produces": ["application/json"],
        "tags": ["Signing"],
        "summary": "Submit data for signing",
        "parameters": [
          {
            "description": "Data submission request (JSON format)",
            "name": "request",
            "in": "body",
            "schema": {
              "$ref": "#/definitions/server.SubmitDataRequest"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Data submitted successfully",
            "schema": {
              "$ref": "#/definitions/server.SubmitDataResponse"
            }
          },
          "400": {
            "description": "Bad request",
            "schema": {
              "$ref": "#/definitions/server.ErrorResponse"
            }
          },
          "413": {
            "description": "Data too large",
            "schema": {
              "$ref": "#/definitions/server.ErrorResponse"
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "description": "Get the health status of the server",
        "produces": ["application/json"],
        "tags": ["Health"],
        "summary": "Health check",
        "responses": {
          "200": {
            "description": "Server is healthy",
            "schema": {
              "$ref": "#/definitions/server.HealthResponse"
            }
          }
        }
      }
    },
    "/sign/{uuid}": {
      "get": {
        "description": "Get the web-based signing interface for a specific signing request",
        "produces": ["text/html"],
        "tags": ["Web Interface"],
        "summary": "Get signing form",
        "parameters": [
          {
            "type": "string",
            "description": "Signing request UUID",
            "name": "uuid",
            "in": "path",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "HTML signing form",
            "schema": {
              "type": "string"
            }
          },
          "404": {
            "description": "Signing request not found",
            "schema": {
              "$ref": "#/definitions/server.ErrorResponse"
            }
          }
        }
      }
    },
    "/status": {
      "get": {
        "description": "Get the current status of all signing requests",
        "produces": ["application/json"],
        "tags": ["Status"],
        "summary": "Get server status",
        "responses": {
          "200": {
            "description": "Current server status",
            "schema": {
              "$ref": "#/definitions/server.StatusResponse"
            }
          }
        }
      }
    },
    "/ws": {
      "get": {
        "description": "WebSocket endpoint for real-time notifications about signing requests",
        "tags": ["WebSocket"],
        "summary": "WebSocket connection",
        "responses": {
          "101": {
            "description": "WebSocket connection established"
          }
        }
      }
    },
    "/{uuid}": {
      "get": {
        "description": "Retrieve the unsigned data for a signing request by UUID",
        "produces": ["application/octet-stream", "application/json"],
        "tags": ["Signing"],
        "summary": "Get unsigned data",
        "parameters": [
          {
            "type": "string",
            "description": "Signing request UUID",
            "name": "uuid",
            "in": "path",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Raw binary data",
            "schema": {
              "type": "string"
            }
          },
          "404": {
            "description": "Signing request not found",
            "schema": {
              "$ref": "#/definitions/server.ErrorResponse"
            }
          }
        }
      },
      "post": {
        "description": "Submit the signed data for a signing request",
        "consumes": ["application/json", "application/octet-stream"],
        "produces": ["application/json"],
        "tags": ["Signing"],
        "summary": "Submit signed data",
        "parameters": [
          {
            "type": "string",
            "description": "Signing request UUID",
            "name": "uuid",
            "in": "path",
            "required": true
          },
          {
            "description": "Signed data submission",
            "name": "request",
            "in": "body",
            "schema": {
              "$ref": "#/definitions/server.SubmitSignedDataRequest"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Signed data submitted successfully",
            "schema": {
              "$ref": "#/definitions/server.SuccessResponse"
            }
          },
          "400": {
            "description": "Bad request",
            "schema": {
              "$ref": "#/definitions/server.ErrorResponse"
            }
          },
          "404": {
            "description": "Signing request not found",
            "schema": {
              "$ref": "#/definitions/server.ErrorResponse"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "server.ErrorResponse": {
      "description": "Standard error response structure",
      "type": "object",
      "properties": {
        "error": {
          "description": "Error message",
          "type": "string",
          "example": "Invalid request format"
        }
      }
    },
    "server.HealthResponse": {
      "description": "Server health status response",
      "type": "object",
      "properties": {
        "status": {
          "description": "Health status",
          "type": "string",
          "example": "healthy"
        },
        "timestamp": {
          "description": "Unix timestamp",
          "type": "integer",
          "example": 1640995200
        },
        "version": {
          "description": "Server version",
          "type": "string",
          "example": "1.0.0"
        }
      }
    },
    "server.StatusResponse": {
      "description": "Current server status and statistics",
      "type": "object",
      "properties": {
        "active_requests": {
          "description": "Number of active signing requests",
          "type": "integer",
          "example": 3
        },
        "server_uptime": {
          "description": "Server uptime duration",
          "type": "string",
          "example": "2h30m45s"
        },
        "total_requests": {
          "description": "Total requests processed",
          "type": "integer",
          "example": 150
        }
      }
    },
    "server.SubmitDataRequest": {
      "type": "object"
    },
    "server.SubmitDataResponse": {
      "description": "Response structure after successfully submitting data for signing",
      "type": "object",
      "properties": {
        "message": {
          "description": "Status message",
          "type": "string",
          "example": "Data submitted for signing"
        },
        "signing_url": {
          "description": "URL for the web signing interface",
          "type": "string",
          "example": "http://localhost:8080/sign/123e4567-e89b-12d3-a456-426614174000"
        },
        "uuid": {
          "description": "Unique identifier for the signing request",
          "type": "string",
          "example": "123e4567-e89b-12d3-a456-426614174000"
        }
      }
    },
    "server.SubmitSignedDataRequest": {
      "type": "object"
    },
    "server.SuccessResponse": {
      "description": "Generic success response structure",
      "type": "object",
      "properties": {
        "message": {
          "description": "Success message",
          "type": "string",
          "example": "Signed data received successfully"
        }
      }
    }
  }
}
